{
    "type": "Ext.app.Controller",
    "reference": {
        "name": "items",
        "type": "array"
    },
    "codeClass": null,
    "userConfig": {
        "designer|userClassName": "ContactListController",
        "requires": [
            "Ext.MessageBox"
        ]
    },
    "designerId": "97a1a1c5-bdf2-424b-b7c2-e7e03bb27b1a",
    "cn": [
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "designer|controlQuery": "#ContactList",
                "designer|params": [
                    "contactlist",
                    "contactdetailcontainer",
                    "contactdetailsinfocontainer",
                    "data"
                ],
                "designer|targetType": "contactList",
                "fn": "loadAndShowDetails",
                "implHandler": [
                    "// Set the values of the details panel",
                    "",
                    "",
                    "maineclcontainer = Ext.getCmp('MainECLContainer');",
                    "",
                    "",
                    "// below is setting the correct image for the ContactImageContainer & ContactImage",
                    "var contactimage = contactdetailcontainer.down('#ContactImage');",
                    "var profileImg = Ext.getCmp('ContactDetalsProfileImage');",
                    "",
                    "if(data.photo_url!=null && data.photo_url.length>1){",
                    "    contactimage.setSrc(data.photo_url);",
                    "    profileImg.setSrc(data.photo_url);",
                    "",
                    "}",
                    "else{",
                    "    contactimage.setSrc(\"resources/images/greyman.jpg\");",
                    "    profileImg.setSrc(\"resources/images/greyman.jpg\");",
                    "}",
                    "",
                    "// calculate full name",
                    "var name = data.firstname+\" \";",
                    "if(data.middlename===undefined || data.middlename===null){",
                    "    name+=data.lastname;",
                    "}",
                    "else{",
                    "    name+=data.middlename+\" \"+data.lastname;",
                    "}",
                    "",
                    "// Set the value of Summary Container (minus image which was set above)",
                    "var fullnamelabel = contactdetailcontainer.down(\"#ContactDetailsFullnameLabel\");",
                    "fullnamelabel.setHtml(name);",
                    "",
                    "var positionlabel = contactdetailcontainer.down(\"#ContactDetailsPositionLabel\");",
                    "",
                    "",
                    "if(name.length>40){",
                    "    console.log(\"INFO: Name length greater than 20 charecters. Contracting\");",
                    "    fullnamelabel.setStyle(\"font-size\", \"50%\");",
                    "    positionlabel.setStyle(\"font-size\", \"50%\");",
                    "}",
                    "else if(name.length>30){",
                    "    console.log(\"INFO: Name length greater than 20 charecters. Contracting\");",
                    "    fullnamelabel.setStyle(\"font-size\", \"66%\");",
                    "    positionlabel.setStyle(\"font-size\", \"66%\");",
                    "}",
                    "else if(name.length>18){",
                    "    console.log(\"INFO: Name length greater than 20 charecters. Contracting\");",
                    "    fullnamelabel.setStyle(\"font-size\", \"75%\");",
                    "    positionlabel.setStyle(\"font-size\", \"75%\");",
                    "}",
                    "else{",
                    "    fullnamelabel.setStyle(\"font-size\", \"100%\");",
                    "",
                    "    if(data.position!=null && data.position.length>1){",
                    "        console.log(\"INFO: Position length greater than 25 charecters. Contracting.\");",
                    "        positionlabel.setHtml(data.position);",
                    "",
                    "        if(data.position.length>50){",
                    "            positionlabel.setStyle(\"font-size: 50%\");",
                    "        }",
                    "        else if(data.position.length>35){",
                    "            positionlabel.setStyle(\"font-size: 66%\");",
                    "        }",
                    "        else if(data.position.length>25){",
                    "            positionlabel.setStyle(\"font-size: 75%\");",
                    "        }",
                    "        else{",
                    "            positionlabel.setStyle(\"font-size: 100%\");",
                    "        }",
                    "    }",
                    "}",
                    "",
                    "",
                    "",
                    "",
                    "// ** Setting values in ContactDetailsInfoContainer **",
                    "",
                    "var listObj = [];",
                    "",
                    "var emailfield = contactdetailcontainer.down(\"#emaillabel\");",
                    "if(data.email!=null && data.email.length>1){",
                    "    emailfield.setStyleHtmlCls('ContactDetailClickableValueLabel');",
                    "    emailfield.setHtml(data.email);",
                    "",
                    "    var emailObj = {",
                    "        action : \"email\",",
                    "        location: data.email,",
                    "        address: data.email,",
                    "        icon: \"resources/images/icon_email.png\",",
                    "        icon2: 'emailIcon',",
                    "        label1: \"Email \"+data.firstname,",
                    "        label2: data.email",
                    "    };",
                    "    listObj.push(emailObj);",
                    "",
                    "}",
                    "",
                    "var phonefield = contactdetailcontainer.down(\"#workphonelabel\");",
                    "if(data.workphone!=null && data.workphone.length>1){",
                    "    phonefield.setStyleHtmlCls('ContactDetailClickableValueLabel');",
                    "    phonefield.setHtml(data.workphone);",
                    "",
                    "    var workphoneObj = {",
                    "        action: \"call\",",
                    "        location: data.workphone,",
                    "        icon: \"resources/images/icon_deskphone.png\",",
                    "        icon2: 'phoneIcon',",
                    "        label1: \"Call Work Phone \",",
                    "        label2: data.workphone",
                    "    };",
                    "    listObj.push(workphoneObj);",
                    "}",
                    "",
                    "if(data.bbmpin!=null && data.bbmpin.length>1 && /^[A-Fa-f0-9]{8}$/.test(data.bbmpin)){",
                    "    var blackberryBBMObj = {",
                    "        action: \"bbm\",",
                    "        location: data.bbmpin,",
                    "        icon: \"resources/images/icon_bbm.png\",",
                    "        icon2: 'bbmIcon',",
                    "        label1: \"BBM\",",
                    "        label2: data.bbmpin",
                    "    };",
                    "    listObj.push(blackberryBBMObj);",
                    "}",
                    "",
                    "if(data.blackberry!=null && data.blackberry.length>1){",
                    "",
                    "    var blackberryCallObj = {",
                    "        action: \"call\",",
                    "        location: data.blackberry,",
                    "        icon: \"resources/images/icon_blackberry.png\",",
                    "        icon2: 'blackberryIcon',",
                    "        label1: \"Call BlackBerry\",",
                    "        label2: data.blackberry",
                    "",
                    "    };",
                    "    var blackberrySMSObj = {",
                    "        action: \"sms\",",
                    "        location: data.blackberry,",
                    "        icon: \"resources/images/icon_sms.png\",",
                    "        icon2: 'smsIcon',",
                    "        label1: \"SMS BlackBerry\",",
                    "        label2: data.blackberry",
                    "",
                    "    };",
                    "    listObj.push(blackberryCallObj);",
                    "    listObj.push(blackberrySMSObj);",
                    "",
                    "}",
                    "",
                    "if(data.location!=null && data.location.length>1){",
                    "    var locationfield = contactdetailcontainer.down(\"#locationlabel\");",
                    "    locationfield.setHtml(data.location);",
                    "",
                    "    var locationObj = \t{",
                    "        action: \"map\",",
                    "        location: data.location,",
                    "        icon: \"resources/images/icon_map.png\",",
                    "        icon2: 'mapIcon',",
                    "        label1: \"Maps\",",
                    "        label2: data.location",
                    "    };",
                    "    listObj.push(locationObj);",
                    "",
                    "    // Find map",
                    "    Ext.Ajax.request({",
                    "        url: 'http://maps.googleapis.com/maps/api/geocode/json',",
                    "        method: 'GET',",
                    "        params: {",
                    "            address: data.location,",
                    "            sensor: false",
                    "        },",
                    "        success: function(response, opts) {",
                    "            var obj = Ext.decode(response.responseText);",
                    "            console.dir(obj);",
                    "            if(obj.results[0].geometry.location){",
                    "                Ext.getCmp('ContactDetailMapContainer').location = obj.results[0].geometry.location;",
                    "            }",
                    "        },",
                    "        failure: function(response, opts) {",
                    "            console.log('Error: server-side failure with status code ' + response.status);",
                    "        }",
                    "    });",
                    "",
                    "",
                    "}",
                    "",
                    "if(data.twitter!=null && data.twitter.length>1){",
                    "    var twitterObj = {",
                    "        action: \"twitter\",",
                    "        location: data.twitter,",
                    "        icon: \"resources/images/icon_twitter.png\",",
                    "        icon2: 'twitterIcon',",
                    "        label1: \"Twitter\",",
                    "        label2: data.twitter",
                    "    };",
                    "    listObj.push(twitterObj);",
                    "}",
                    "",
                    "",
                    "var contactdetailstoolbar = contactdetailcontainer.down('#ContactDetailsHeaderToolbar');",
                    "contactdetailstoolbar.setTitle(name); // ContactDetailsToolbar",
                    "contactdetailcontainer.setData(data);",
                    "",
                    "var detailinfoactionlist = Ext.getCmp('DetailInfoActionList');",
                    "",
                    "var infocontainer = Ext.getCmp('ContactDetailsInfoContainer');",
                    "var itemHeight = 53;",
                    "",
                    "infocontainer.setHeight(itemHeight*listObj.length+listObj.length*2+1);",
                    "",
                    "detailinfoactionlist.setHeight(itemHeight*listObj.length);",
                    "",
                    "var actionstore = Ext.getStore('ActionStore');",
                    "actionstore.setData(listObj);",
                    "detailinfoactionlist.refresh();",
                    "",
                    "maineclcontainer.setActiveItem(contactdetailcontainer);"
                ],
                "name": "loadAndShowDetails"
            },
            "designerId": "ab4aa49e-7b27-4406-90ed-437b7325c278"
        }
    ]
}